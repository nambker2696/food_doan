;var postWishlistCallback,WishlistCreateWidgetButton=function(){var a=this;a.Logged=ko.observable(!1),a.Login=function(b){angular.element('div[ng-controller="HelperCtrl"]').scope().ShowDlgLogin(function(c){c.LoggedIn&&b&&(a.Logged(!0),b())})},a.ListAction=function(){a.Logged()?a.PrepareCreateForm():a.Login(a.ListAction)},a.EndSavingList=function(a){a!=null&&(postWishlistCallback=null,window.location.href=a.PublicUrl)},a.PrepareCreateForm=function(b){if(!window.popupEditList)return;popupEditList.Show({Id:null},function(b){a.EndSavingList(b),popupEditList.Close()})}},wishlistCreateWidgetButton=new WishlistCreateWidgetButton;$(function(){$("#wishListFormWrapper").length==0&&$("body").append('<div id="wishListFormWrapper" ></div>'),$("#wishlistContextContainer").length==0&&$("body").append('<div id="wishlistContextContainer"></div>'),ko.applyBindings(wishlistCreateWidgetButton,document.getElementById("wishlistContextContainer")),$(".add-new-list").on("click",function(){wishlistCreateWidgetButton&&wishlistCreateWidgetButton.ListAction()})});var RestaurantWishlistModel=function(){var a=this;a.resId=ko.observable(0),a.resName=ko.observable(""),a.resUrl=ko.observable(""),a.items=ko.observableArray([]),a.count=ko.observable(0),a.lastId=ko.observable(0),a.total=ko.observable(0),a.totalRemaining=ko.observable(0),a.loading=ko.observable(!1),a.show=function(b){$("#wishlist-popup-dialog").modal({persist:!0}),$("#simplemodal-container").css("height","440px"),$("#simplemodal-container").css("width","500px"),$(window).resize();if(!a.loading()){a.loading(!0);var c=new Date;$.get("/__get/list/GetListsByResId?resid="+b+"&d="+c.getTime(),function(c){if(c.success){var d=c.data;a.resId(b),a.resName(d.ResName),a.resUrl(d.ResUrl);var e=d.Lists;a.items.removeAll();for(var f=0;f<e.Items.length;f++)a.cookListData(e.Items[f]),a.items.push(e.Items[f]);a.total(e.TotalResult),a.totalRemaining(e.TotalResult-e.Count),a.lastId(e.LastId),a.count(e.Count),a.loading(!1)}else a.loading(!1)})}},a.getListUrl=function(a){return"/__get/list/"+a.OwnerUserName+"/"+a.Name},a.moreLoading=ko.observable(!1),a.loadmore=function(){if(!a.moreLoading()&&a.totalRemaining()>0){a.moreLoading(!0);var b=new Date;$.get("/__get/list/GetListsByResId?resid="+a.resId()+"&d="+b.getTime()+"&lastid="+a.lastId(),function(b){if(b.success){var c=b.data,d=c.Lists;for(var e=0;e<d.Items.length;e++)a.cookListData(d.Items[e]),a.items.push(d.Items[e]);a.totalRemaining(d.TotalResult-d.Count),a.lastId(d.LastId),a.moreLoading(!1)}else a.moreLoading(!1)})}},a.Subscribe=function(a){var b=a.Id,c="/LikeComment/Subscribe",d={id:b,type:"List"};$.post(c,d,function(b){b.Success&&a.IsSubscribe(!0)})},a.UnSubscribe=function(a){var b=a.Id,c="/LikeComment/UnSubscribe",d={id:b,type:"List"};$.post(c,d,function(b){b.Success&&a.IsSubscribe(!1)})},a.cookListData=function(a){a.IsSubscribe=ko.observable(a.IsSubscribe)}},resWishlishModel=new RestaurantWishlistModel;$(function(){$("a.list-counter").click(function(){resWishlishModel.show($(this).attr("resid"))}),$("#wishlist-popup-div").length>0&&ko.applyBindings(resWishlishModel,document.getElementById("wishlist-popup-div"))})
